name: "olmo3-microanneal-pdfquality-top50-pstar"
description: "OLMo3 7B microanneal to 10B Tokens from top 50th percentile pdf quality"
budget: "ai2/oe-training"
workspace: "ai2/oe-data"
nodes: 2
gpus: 8
preemptible: true
max_tokens: 10_000_000_000
global_batch_size: 2097152
sequence_length: 8192
seed: 1337
model: "olmo2_7B_swafix"
tokenizer: "dolma2"
priority: high
cluster: ai2/augusta-google-1
rank_microbatch_size: 16384
scheduler_type: linear
warmup_steps: 0
activation_checkpointing: true
annealing:
  enabled: true
load_path: gs://ai2-llm/checkpoints/OLMo3-7B-swafix/step289000
load_state: false

dataset:
  sources:
  # 50 % web
  - name: web
    target_ratio: 0.5
    paths:
      - s3://ai2-llm/preprocessed/cc_all_dressed/all_dressed_v3_subsamples/midtrain_pools/6B/allenai/dolma2-tokenizer/*.npy

  # 50 % PDF quality
  # - name: pdf-quality-top50-adult
  #   target_ratio: 0.0
  #   paths:
  #     - s3://ai2-llm/preprocessed/s2pdf/s2pdf_dedupe_minhash_v1_with_no_pii_basic_quality_datadelve_norefs_mdtables_v2_denylisted_quality_tagged_partitioned_category_sample_8k_tokenized/adult/*.npy
  - name: pdf-quality-top50-art_design
    target_ratio: 0.00035
    paths:
      - s3://ai2-llm/preprocessed/s2pdf/s2pdf_dedupe_minhash_v1_with_no_pii_basic_quality_datadelve_norefs_mdtables_v2_denylisted_quality_tagged_partitioned_category_sample_8k_tokenized/art_design/*.npy
  - name: pdf-quality-top50-crime_law
    target_ratio: 0.00775
    paths:
      - s3://ai2-llm/preprocessed/s2pdf/s2pdf_dedupe_minhash_v1_with_no_pii_basic_quality_datadelve_norefs_mdtables_v2_denylisted_quality_tagged_partitioned_category_sample_8k_tokenized/crime_law/*.npy
  - name: pdf-quality-top50-education_jobs
    target_ratio: 0.0258
    paths:
      - s3://ai2-llm/preprocessed/s2pdf/s2pdf_dedupe_minhash_v1_with_no_pii_basic_quality_datadelve_norefs_mdtables_v2_denylisted_quality_tagged_partitioned_category_sample_8k_tokenized/education_jobs/*.npy
  - name: pdf-quality-top50-entertainment
    target_ratio: 0.0011
    paths:
      - s3://ai2-llm/preprocessed/s2pdf/s2pdf_dedupe_minhash_v1_with_no_pii_basic_quality_datadelve_norefs_mdtables_v2_denylisted_quality_tagged_partitioned_category_sample_8k_tokenized/entertainment/*.npy
  # - name: pdf-quality-top50-fashion_beauty
  #   target_ratio: 0.0
  #   paths:
  #     - s3://ai2-llm/preprocessed/s2pdf/s2pdf_dedupe_minhash_v1_with_no_pii_basic_quality_datadelve_norefs_mdtables_v2_denylisted_quality_tagged_partitioned_category_sample_8k_tokenized/fashion_beauty/*.npy
  - name: pdf-quality-top50-finance_business
    target_ratio: 0.007
    paths:
      - s3://ai2-llm/preprocessed/s2pdf/s2pdf_dedupe_minhash_v1_with_no_pii_basic_quality_datadelve_norefs_mdtables_v2_denylisted_quality_tagged_partitioned_category_sample_8k_tokenized/finance_business/*.npy
  # - name: pdf-quality-top50-food_dining
  #   target_ratio: 0.0
  #   paths:
  #     - s3://ai2-llm/preprocessed/s2pdf/s2pdf_dedupe_minhash_v1_with_no_pii_basic_quality_datadelve_norefs_mdtables_v2_denylisted_quality_tagged_partitioned_category_sample_8k_tokenized/food_dining/*.npy
  # - name: pdf-quality-top50-games
  #   target_ratio: 0.0
  #   paths:
  #     - s3://ai2-llm/preprocessed/s2pdf/s2pdf_dedupe_minhash_v1_with_no_pii_basic_quality_datadelve_norefs_mdtables_v2_denylisted_quality_tagged_partitioned_category_sample_8k_tokenized/games/*.npy
  - name: pdf-quality-top50-hardware
    target_ratio: 0.0024
    paths:
      - s3://ai2-llm/preprocessed/s2pdf/s2pdf_dedupe_minhash_v1_with_no_pii_basic_quality_datadelve_norefs_mdtables_v2_denylisted_quality_tagged_partitioned_category_sample_8k_tokenized/hardware/*.npy
  - name: pdf-quality-top50-health
    target_ratio: 0.05935
    paths:
      - s3://ai2-llm/preprocessed/s2pdf/s2pdf_dedupe_minhash_v1_with_no_pii_basic_quality_datadelve_norefs_mdtables_v2_denylisted_quality_tagged_partitioned_category_sample_8k_tokenized/health/*.npy
  - name: pdf-quality-top50-history
    target_ratio: 0.0027
    paths:
      - s3://ai2-llm/preprocessed/s2pdf/s2pdf_dedupe_minhash_v1_with_no_pii_basic_quality_datadelve_norefs_mdtables_v2_denylisted_quality_tagged_partitioned_category_sample_8k_tokenized/history/*.npy
  - name: pdf-quality-top50-home_hobbies
    target_ratio: 0.00035
    paths:
      - s3://ai2-llm/preprocessed/s2pdf/s2pdf_dedupe_minhash_v1_with_no_pii_basic_quality_datadelve_norefs_mdtables_v2_denylisted_quality_tagged_partitioned_category_sample_8k_tokenized/home_hobbies/*.npy
  - name: pdf-quality-top50-industrial
    target_ratio: 0.0269
    paths:
      - s3://ai2-llm/preprocessed/s2pdf/s2pdf_dedupe_minhash_v1_with_no_pii_basic_quality_datadelve_norefs_mdtables_v2_denylisted_quality_tagged_partitioned_category_sample_8k_tokenized/industrial/*.npy
  - name: pdf-quality-top50-literature
    target_ratio: 0.0045
    paths:
      - s3://ai2-llm/preprocessed/s2pdf/s2pdf_dedupe_minhash_v1_with_no_pii_basic_quality_datadelve_norefs_mdtables_v2_denylisted_quality_tagged_partitioned_category_sample_8k_tokenized/literature/*.npy
  - name: pdf-quality-top50-politics
    target_ratio: 0.0092
    paths:
      - s3://ai2-llm/preprocessed/s2pdf/s2pdf_dedupe_minhash_v1_with_no_pii_basic_quality_datadelve_norefs_mdtables_v2_denylisted_quality_tagged_partitioned_category_sample_8k_tokenized/politics/*.npy
  - name: pdf-quality-top50-religion
    target_ratio: 0.0026
    paths:
      - s3://ai2-llm/preprocessed/s2pdf/s2pdf_dedupe_minhash_v1_with_no_pii_basic_quality_datadelve_norefs_mdtables_v2_denylisted_quality_tagged_partitioned_category_sample_8k_tokenized/religion/*.npy
  - name: pdf-quality-top50-science_tech
    target_ratio: 0.2976
    paths:
      - s3://ai2-llm/preprocessed/s2pdf/s2pdf_dedupe_minhash_v1_with_no_pii_basic_quality_datadelve_norefs_mdtables_v2_denylisted_quality_tagged_partitioned_category_sample_8k_tokenized/science_tech/*.npy
  # - name: pdf-quality-top50-social_life
  #   target_ratio: 0.0
  #   paths:
  #     - s3://ai2-llm/preprocessed/s2pdf/s2pdf_dedupe_minhash_v1_with_no_pii_basic_quality_datadelve_norefs_mdtables_v2_denylisted_quality_tagged_partitioned_category_sample_8k_tokenized/social_life/*.npy
  - name: pdf-quality-top50-software
    target_ratio: 0.0059
    paths:
      - s3://ai2-llm/preprocessed/s2pdf/s2pdf_dedupe_minhash_v1_with_no_pii_basic_quality_datadelve_norefs_mdtables_v2_denylisted_quality_tagged_partitioned_category_sample_8k_tokenized/software/*.npy
  - name: pdf-quality-top50-software_dev
    target_ratio: 0.0435
    paths:
      - s3://ai2-llm/preprocessed/s2pdf/s2pdf_dedupe_minhash_v1_with_no_pii_basic_quality_datadelve_norefs_mdtables_v2_denylisted_quality_tagged_partitioned_category_sample_8k_tokenized/software_dev/*.npy
  - name: pdf-quality-top50-sports_fitness
    target_ratio: 0.0019
    paths:
      - s3://ai2-llm/preprocessed/s2pdf/s2pdf_dedupe_minhash_v1_with_no_pii_basic_quality_datadelve_norefs_mdtables_v2_denylisted_quality_tagged_partitioned_category_sample_8k_tokenized/sports_fitness/*.npy
  - name: pdf-quality-top50-transportation
    target_ratio: 0.0011
    paths:
      - s3://ai2-llm/preprocessed/s2pdf/s2pdf_dedupe_minhash_v1_with_no_pii_basic_quality_datadelve_norefs_mdtables_v2_denylisted_quality_tagged_partitioned_category_sample_8k_tokenized/transportation/*.npy
  # - name: pdf-quality-top50-travel
  #   target_ratio: 0.0
  #   paths:
  #     - s3://ai2-llm/preprocessed/s2pdf/s2pdf_dedupe_minhash_v1_with_no_pii_basic_quality_datadelve_norefs_mdtables_v2_denylisted_quality_tagged_partitioned_category_sample_8k_tokenized/travel/*.npy
